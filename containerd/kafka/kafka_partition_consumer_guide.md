
# Kafka 메시지 소비 방식 및 파티션 수, Consumer Group 수 정리

## 1. Kafka 메시지 소비 방식

Kafka는 메시지를 **파티션 단위로 분배**하여 소비합니다. 주요 동작 방식은 다음과 같습니다:

- **파티션**: Kafka 토픽은 여러 파티션으로 나뉘며, 각 파티션은 **메시지 순서를 보장**합니다.
- **Consumer Group**: Kafka는 **Consumer Group 단위로 메시지를 분배**하며, 같은 Group에 속한 Consumer들은 **파티션을 공유**하지 않습니다.
- **파티션과 Consumer의 매핑**:
  - 하나의 파티션은 하나의 Consumer에게만 할당됩니다.
  - 하나의 Consumer는 여러 파티션을 처리할 수 있습니다.

---

## 2. 파티션 수와 Consumer 수에 따른 동작

| **파티션 수** | **Consumer 수** | **동작 방식**                                                   |
|---------------|-----------------|-----------------------------------------------------------------|
| 파티션 수 > Consumer 수 | N개            | 일부 Consumer가 여러 파티션을 처리합니다.                         |
| 파티션 수 = Consumer 수 | N개            | 각 Consumer가 하나의 파티션을 처리하며, 최대 병렬 처리 가능.         |
| 파티션 수 < Consumer 수 | N개            | 일부 Consumer는 할당받은 파티션이 없어 메시지를 소비하지 않습니다. |

---

## 3. 파티션 수와 Consumer Group 수에 따른 동작

| **파티션 수** | **Consumer Group 수** | **동작 방식**                                                                 |
|---------------|-----------------------|-------------------------------------------------------------------------------|
| 파티션 수 = N | Consumer Group 수 = 1 | 하나의 Consumer Group이 모든 메시지를 소비하며, 파티션 단위로 메시지를 분배받음. |
| 파티션 수 = N | Consumer Group 수 = M | 각 Consumer Group이 모든 파티션의 메시지를 독립적으로 소비함.                 |

---

## 4. 추천 설정 가이드

1. **파티션 수 ≥ Consumer 수**로 설정하여 최대 병렬 처리가 가능하도록 합니다.
2. Consumer Group 수는 **필요한 독립적인 소비자 그룹 수에 따라 설정**합니다.
   - 예: 서로 다른 시스템에서 같은 메시지를 독립적으로 소비해야 할 경우 여러 Consumer Group을 설정.
3. 파티션 수는 **예상되는 처리량과 병렬 처리 요구사항**에 맞춰 설정합니다.

---

## 5. 예시

### 예시 1: 파티션 3개, Consumer 3개, Consumer Group 1개
- 각 Consumer는 하나의 파티션을 처리.
- 최대 병렬 처리 가능.

### 예시 2: 파티션 3개, Consumer 6개, Consumer Group 1개
- 3명의 Consumer만 메시지를 소비하며, 나머지 3명은 대기 상태.

### 예시 3: 파티션 3개, Consumer 3개, Consumer Group 2개
- 각 Consumer Group이 모든 파티션의 메시지를 독립적으로 소비.

---

이 문서는 Kafka 메시지 소비 방식과 파티션 수, Consumer Group 수에 따른 동작 방식을 설명하고, 설정 가이드를 제공합니다.
